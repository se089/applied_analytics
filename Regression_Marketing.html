
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Code &#8212; Projektdokumentation</title>
    
  <link href="_static/css/theme.css" rel="stylesheet" />
  <link href="_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Clustering" href="Clustering.html" />
    <link rel="prev" title="Regression" href="Regression.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Projektdokumentation</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Dieses Buch durchsuchen ..." aria-label="Dieses Buch durchsuchen ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Projektdokumentation
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  Vorgehen
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Projektplanung.html">
   Projektplanung
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Unternehmen.html">
   Das Unternehmen
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  Use Cases
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="Regression.html">
   Regression
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Code
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="Clustering.html">
   Clustering
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="Clustering_Marketing.html">
     Code
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="Recommender.html">
   Recommender
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="Recommendation_Marketing.html">
     Code
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Navigation umschalten" aria-controls="site-navigation"
                title="Navigation umschalten" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Laden Sie diese Seite herunter"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/Regression_Marketing.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Quelldatei herunterladen" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="In PDF drucken"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Quell-Repository"><i
                    class="fab fa-github"></i>Repository</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FRegression_Marketing.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Öffnen Sie ein Problem"><i class="fas fa-lightbulb"></i>offenes Thema</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Vollbildmodus"
        title="Vollbildmodus"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/Regression_Marketing.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Starten Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Inhalt
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Code
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#aim">
     Aim
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data">
     Data
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#import-data">
   Import data
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#drop-tv-column">
     Drop TV column
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#first-look-into-the-data">
     First look into the data
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-preparation">
   Data Preparation
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#check-missing-values">
     Check missing values
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#fill-missing-values">
       Fill missing values
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#drop-missing-values">
       Drop missing values
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#add-column-total-spent">
       Add column Total_spent
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-splitting">
   Data splitting
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-exploration">
   Data Exploration
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#correlation">
     Correlation
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#learnings">
       Learnings
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#modeling">
   Modeling
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pipeline-for-pre-processing">
     Pipeline for Pre-Processing
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pipeline-for-modeling">
     Pipeline for modeling
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simple-linear-regression">
     Simple linear Regression
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#prepare-features-and-target-variable">
       Prepare Features and target variable
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#fit-data">
       Fit data
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#evaluation-with-train-data">
       Evaluation with train-data
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#multiple-linear-regression">
     Multiple linear Regression
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       Prepare Features and target variable
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       Fit Data
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#standard-multiple-regression">
         Standard multiple regression
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#perform-hyperparameter-tuning">
         Perform Hyperparameter tuning
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#evaluate-data-with-trainings-set">
       Evaluate data with trainings-set
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#lasso-regression">
     Lasso Regression
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#find-best-alpha">
       Find best alpha
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#perform-modeling">
       Perform Modeling
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gradient-boosting-regressor">
     Gradient Boosting Regressor
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#feature-importance">
       Feature Importance
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#comparing-the-different-models">
     Comparing the different models
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#evaluation-with-test-data">
   Evaluation with Test-Data
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#conclusion">
   Conclusion
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#import necessary libraries</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span> 
<span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;ticks&quot;</span><span class="p">,</span> <span class="n">color_codes</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="code">
<h1>Code<a class="headerlink" href="#code" title="Permalink to this headline">¶</a></h1>
<div class="section" id="aim">
<h2>Aim<a class="headerlink" href="#aim" title="Permalink to this headline">¶</a></h2>
<p>The aim of the model is to predict how much sales will be achieved with a certain campaign depending on how much money has been invested in different communication channels. It shows which channel is most effective for driving sales and should help the marketing department decide how to better distribute their budget for future campaigns. Furthermore, the prediction of sales allows better planning and forecasting the demand and website traffic after a certain campaign based on how much money was spent on it on different channels. Each row stands for one campaign.</p>
</div>
<div class="section" id="data">
<h2>Data<a class="headerlink" href="#data" title="Permalink to this headline">¶</a></h2>
<p>The original source is from kaggle: <a class="reference external" href="https://www.kaggle.com/harrimansaragih/dummy-advertising-and-sales-data">https://www.kaggle.com/harrimansaragih/dummy-advertising-and-sales-data</a>. The column names were changed to better fit the defined use case and company. In order to increase the complexity and to obtain a more realistic data set, the column “TV” will be dropped, as the original dataset has an 1:1 linear correlation with the target variable sales. Each row represents one campaign, which was played in either one (european) country or across different countries.</p>
<ul class="simple">
<li><p>Print: Money spent on Print advertising (in thousands)</p></li>
<li><p>Social: Money spent for social media advertising (influencer marketing excluded) (in thousands)</p></li>
<li><p>Influencer: Size and reach of the influencer worked with in the campaign</p></li>
<li><p>Sales: Sales during the term of a campaign (in thousands)</p></li>
</ul>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="import-data">
<h1>Import data<a class="headerlink" href="#import-data" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../Regression_marketing_data.csv&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">encoding</span> <span class="o">=</span> <span class="s1">&#39;unicode_escape&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="drop-tv-column">
<h2>Drop TV column<a class="headerlink" href="#drop-tv-column" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#drop TV column for test</span>
<span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;TV&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="first-look-into-the-data">
<h2>First look into the data<a class="headerlink" href="#first-look-into-the-data" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#first look into the data</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Print</th>
      <th>Social</th>
      <th>Influencer</th>
      <th>Sales</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6.566231</td>
      <td>2.907983</td>
      <td>Mega</td>
      <td>54.732757</td>
    </tr>
    <tr>
      <th>1</th>
      <td>9.237765</td>
      <td>2.409567</td>
      <td>Mega</td>
      <td>46.677897</td>
    </tr>
    <tr>
      <th>2</th>
      <td>15.886446</td>
      <td>2.913410</td>
      <td>Mega</td>
      <td>150.177829</td>
    </tr>
    <tr>
      <th>3</th>
      <td>30.020028</td>
      <td>6.922304</td>
      <td>Mega</td>
      <td>298.246340</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8.437408</td>
      <td>1.405998</td>
      <td>Micro</td>
      <td>56.594181</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 4572 entries, 0 to 4571
Data columns (total 4 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   Print       4568 non-null   float64
 1   Social      4566 non-null   float64
 2   Influencer  4572 non-null   object 
 3   Sales       4566 non-null   float64
dtypes: float64(3), object(1)
memory usage: 143.0+ KB
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="data-preparation">
<h1>Data Preparation<a class="headerlink" href="#data-preparation" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#change data type</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Influencer&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Influencer&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="check-missing-values">
<h2>Check missing values<a class="headerlink" href="#check-missing-values" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">(),</span><span class="n">yticklabels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Regression_Marketing_12_0.png" src="_images/Regression_Marketing_12_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Print         4
Social        6
Influencer    0
Sales         6
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="section" id="fill-missing-values">
<h3>Fill missing values<a class="headerlink" href="#fill-missing-values" title="Permalink to this headline">¶</a></h3>
<p>The missing values of the Print and Social Media column are probably a result from campaigns, which were not played on the channel. Therefore, we will keep these rows and replace the NaN values with 0.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#fill missing values of channel column</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Print&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Social&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># all remaining rows with NA-values in any column</span>
<span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Print</th>
      <th>Social</th>
      <th>Influencer</th>
      <th>Sales</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>208</th>
      <td>25.598379</td>
      <td>5.514787</td>
      <td>Nano</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>214</th>
      <td>36.466753</td>
      <td>5.635992</td>
      <td>Mega</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>221</th>
      <td>24.220634</td>
      <td>0.285898</td>
      <td>Micro</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>226</th>
      <td>8.726783</td>
      <td>0.497838</td>
      <td>Mega</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>231</th>
      <td>6.809752</td>
      <td>0.011451</td>
      <td>Macro</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>236</th>
      <td>1.384415</td>
      <td>2.398129</td>
      <td>Nano</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="drop-missing-values">
<h3>Drop missing values<a class="headerlink" href="#drop-missing-values" title="Permalink to this headline">¶</a></h3>
<p>We will drop the remaining NULL-values in our target variable.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Sales&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="add-column-total-spent">
<h3>Add column Total_spent<a class="headerlink" href="#add-column-total-spent" title="Permalink to this headline">¶</a></h3>
<p>We will calculate the total amount spent per campaign (Sum of all channels) to identify if there is a correlation between the total sum and our target variables sales.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Create column</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Total_spent&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Print&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Social&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Print</th>
      <th>Social</th>
      <th>Influencer</th>
      <th>Sales</th>
      <th>Total_spent</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6.566231</td>
      <td>2.907983</td>
      <td>Mega</td>
      <td>54.732757</td>
      <td>9.474214</td>
    </tr>
    <tr>
      <th>1</th>
      <td>9.237765</td>
      <td>2.409567</td>
      <td>Mega</td>
      <td>46.677897</td>
      <td>11.647332</td>
    </tr>
    <tr>
      <th>2</th>
      <td>15.886446</td>
      <td>2.913410</td>
      <td>Mega</td>
      <td>150.177829</td>
      <td>18.799856</td>
    </tr>
    <tr>
      <th>3</th>
      <td>30.020028</td>
      <td>6.922304</td>
      <td>Mega</td>
      <td>298.246340</td>
      <td>36.942332</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8.437408</td>
      <td>1.405998</td>
      <td>Micro</td>
      <td>56.594181</td>
      <td>9.843406</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="data-splitting">
<h1>Data splitting<a class="headerlink" href="#data-splitting" title="Permalink to this headline">¶</a></h1>
<p>Before we dive deeper into the data, we already divide the dataset into trainings- and test-data. This prevents overfitting the model to the conditions in the test/validation dataset and gives us the opportunity to evaluate our model unbiased and under real conditions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Train test split</span>
<span class="n">train_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">test_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">train_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="data-exploration">
<h1>Data Exploration<a class="headerlink" href="#data-exploration" title="Permalink to this headline">¶</a></h1>
<p>The data exploration will be performed with our test dataset.</p>
<ul class="simple">
<li><p>On average we spent 18.14 Million € for Print and only 3.33 Million € for Social Media.</p></li>
<li><p>For our most expensive campaign we spent 57.16 Million €.</p></li>
<li><p>On average we spent 21.47 Million € in total for one campaign.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Print</th>
      <th>Social</th>
      <th>Sales</th>
      <th>Total_spent</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>3653.000000</td>
      <td>3653.000000</td>
      <td>3653.000000</td>
      <td>3653.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>18.148261</td>
      <td>3.331223</td>
      <td>192.504898</td>
      <td>21.479484</td>
    </tr>
    <tr>
      <th>std</th>
      <td>9.687832</td>
      <td>2.225839</td>
      <td>92.851664</td>
      <td>11.178079</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>31.199409</td>
      <td>0.206238</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>10.403711</td>
      <td>1.524062</td>
      <td>112.345307</td>
      <td>12.351913</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>17.898432</td>
      <td>3.057987</td>
      <td>189.932495</td>
      <td>20.961877</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>25.521124</td>
      <td>4.824378</td>
      <td>271.547402</td>
      <td>29.932481</td>
    </tr>
    <tr>
      <th>max</th>
      <td>48.871161</td>
      <td>13.981662</td>
      <td>364.079751</td>
      <td>57.163369</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="section" id="correlation">
<h2>Correlation<a class="headerlink" href="#correlation" title="Permalink to this headline">¶</a></h2>
<p>In order to get a first glimpse about the correlation between the features and our target variable <strong>Sales</strong>, we create a heatmap and pairplot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#heatmap for correlation between the numerical variables</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">train_df</span><span class="o">.</span><span class="n">corr</span><span class="p">(),</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="_images/Regression_Marketing_27_1.png" src="_images/Regression_Marketing_27_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#pairplot of numerical variables</span>
<span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">train_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;seaborn.axisgrid.PairGrid at 0x7fa682651150&gt;
</pre></div>
</div>
<img alt="_images/Regression_Marketing_28_1.png" src="_images/Regression_Marketing_28_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># check correlation with categorical variables</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Influencer&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;Sales&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">train_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;Influencer&#39;, ylabel=&#39;Sales&#39;&gt;
</pre></div>
</div>
<img alt="_images/Regression_Marketing_29_1.png" src="_images/Regression_Marketing_29_1.png" />
</div>
</div>
<div class="section" id="learnings">
<h3>Learnings<a class="headerlink" href="#learnings" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>There is a strong positive correlation between Total amount spent and the two channels. That’s because the total amount is a result from these two features.</p></li>
<li><p>The spendings for <em>social media</em> is right skewed, which means that we have some higher values on the right end of the distribution.</p></li>
<li><p>The heatmap and the pairplot reveal a strong, positive and linear correlation between our target variable <strong>sales</strong>, money spent for <em>Print</em> (Correlation Coefficient: 0.87) and total amount spent (Correlation Coefficient: 0.86).</p></li>
<li><p>There is also a medium, positive correlation between the <em>social media</em> channel and our target variable. (Correlation Coefficient: 0.53) It seems like all campaign gather in the area below a line which serves as a kind of limit.</p></li>
<li><p>Surprisingly, the boxplots show only little difference in sales for different influencer sizes. This would mean that working with micro or even nano influencers is just as efficient as working with large influencers as it generates similar sales.</p></li>
<li><p>However, since we don’t have any info on how many influencers we worked with per campaign and how much money we spent on them, we can’t say whether working with nano-influencers is more profitable.</p></li>
</ul>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="modeling">
<h1>Modeling<a class="headerlink" href="#modeling" title="Permalink to this headline">¶</a></h1>
<p>Because of the strong correlation of <em>Print</em> and <strong>Sales</strong> we will try a simple, linear regression model and compare it with a multi, linear regression model as well as with a lasso regression and XGBoost algorithm. Firstly, we will create a pipeline including different Pre-Processing steps as well as the Regression algorithm. In addition, we will create a dictionary to collect all scores and define a function to calculate the adjusted r2-score.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Pre-Processing</span>
<span class="kn">from</span> <span class="nn">sklearn.compose</span> <span class="kn">import</span> <span class="n">ColumnTransformer</span>
<span class="kn">from</span> <span class="nn">sklearn.compose</span> <span class="kn">import</span> <span class="n">make_column_selector</span> <span class="k">as</span> <span class="n">selector</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.impute</span> <span class="kn">import</span> <span class="n">SimpleImputer</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span><span class="p">,</span> <span class="n">OneHotEncoder</span>

<span class="c1">#Pipeline/Algorithm</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="kn">import</span> <span class="n">SelectKBest</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span><span class="p">,</span><span class="n">KFold</span><span class="p">,</span><span class="n">GridSearchCV</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="c1">#from sklearn.ensemble import RandomForestRegressor</span>

<span class="c1">#Score</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">r2_score</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># dictionary to save all scores</span>
<span class="n">scores</span> <span class="o">=</span> <span class="p">{}</span>

<span class="c1"># function for adjusted R2</span>
<span class="k">def</span> <span class="nf">adj_r2</span><span class="p">(</span><span class="n">r2</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
    <span class="n">adj_r2</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">r2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">-</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">adj_r2</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="pipeline-for-pre-processing">
<h2>Pipeline for Pre-Processing<a class="headerlink" href="#pipeline-for-pre-processing" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Data preprocessing pipeline</span>

<span class="c1"># for numeric features</span>
<span class="n">numeric_transformer</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[</span>
    <span class="p">(</span><span class="s1">&#39;imputer&#39;</span><span class="p">,</span> <span class="n">SimpleImputer</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;constant&#39;</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)),</span>
    <span class="c1">#Standardize data to compensate different ranges of the features (also Lasso Regression works best when all numerical data is distributed around 0)</span>
    <span class="p">(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">())</span>
    <span class="p">])</span>

<span class="c1"># for categorical features  </span>
<span class="n">categorical_transformer</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[</span>
    <span class="c1">#OneHotEncoder firstly replaces each category with a number.</span>
    <span class="c1">#After that, it creates a binary column for each category and returns a matrix (0=wrong category, 1=right category), because the categorical variable, unlike the integer variable, has no natural order.</span>
    <span class="p">(</span><span class="s1">&#39;onehot&#39;</span><span class="p">,</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">handle_unknown</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">))</span>
    <span class="p">])</span>

<span class="c1"># Pipeline</span>
<span class="n">preprocessor</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">(</span><span class="n">transformers</span><span class="o">=</span><span class="p">[</span>
    <span class="p">(</span><span class="s1">&#39;num&#39;</span><span class="p">,</span> <span class="n">numeric_transformer</span><span class="p">,</span> <span class="n">selector</span><span class="p">(</span><span class="n">dtype_exclude</span><span class="o">=</span><span class="s2">&quot;category&quot;</span><span class="p">)),</span>
    <span class="p">(</span><span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="n">categorical_transformer</span><span class="p">,</span> <span class="n">selector</span><span class="p">(</span><span class="n">dtype_include</span><span class="o">=</span><span class="s2">&quot;category&quot;</span><span class="p">))</span>
        <span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="pipeline-for-modeling">
<h2>Pipeline for modeling<a class="headerlink" href="#pipeline-for-modeling" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipe</span><span class="o">=</span><span class="n">Pipeline</span><span class="p">([</span>
                <span class="p">(</span><span class="s1">&#39;preprocessor&#39;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
                <span class="p">(</span><span class="s1">&#39;chi&#39;</span><span class="p">,</span> <span class="n">SelectKBest</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)),</span>
                <span class="p">(</span><span class="s1">&#39;lm&#39;</span><span class="p">,</span> <span class="n">LinearRegression</span><span class="p">())</span>
              <span class="p">])</span>
<span class="c1">#pipe.get_params().keys()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="simple-linear-regression">
<h2>Simple linear Regression<a class="headerlink" href="#simple-linear-regression" title="Permalink to this headline">¶</a></h2>
<p>As there is a positive correlation between our target variable and the total amount spent, we will create a basic simple linear regression model with the two variables <em>Total_spent</em> and <em>sales</em>. In this way we can predict how much sales we can expect based on how much money we spent on a certain campaign. This way, the marketing department can justify its budget and check whether the campaign is achieving the expected effect.</p>
<div class="section" id="prepare-features-and-target-variable">
<h3>Prepare Features and target variable<a class="headerlink" href="#prepare-features-and-target-variable" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Train-Data</span>
<span class="c1"># Select features for simple regression</span>
<span class="n">features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Total_spent&#39;</span><span class="p">]</span>
<span class="n">A_train</span> <span class="o">=</span> <span class="n">train_df</span><span class="p">[</span><span class="n">features</span><span class="p">]</span>

<span class="c1"># Create response</span>
<span class="n">b_train</span> <span class="o">=</span> <span class="n">train_df</span><span class="p">[</span><span class="s1">&#39;Sales&#39;</span><span class="p">]</span>

<span class="c1"># Test-Data</span>
<span class="c1"># Select features for simple regression</span>
<span class="n">A_test</span> <span class="o">=</span> <span class="n">test_df</span><span class="p">[</span><span class="n">features</span><span class="p">]</span>

<span class="c1"># Create response</span>
<span class="n">b_test</span> <span class="o">=</span> <span class="n">test_df</span><span class="p">[</span><span class="s1">&#39;Sales&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A_test</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total_spent    0.459982
dtype: float64
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="fit-data">
<h3>Fit data<a class="headerlink" href="#fit-data" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model_simple</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">A_train</span><span class="p">,</span> <span class="n">b_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/sophiaengstler/opt/anaconda3/envs/jbook/lib/python3.7/site-packages/sklearn/feature_selection/_univariate_selection.py:111: RuntimeWarning: invalid value encountered in true_divide
  msw = sswn / float(dfwn)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b_pred</span> <span class="o">=</span> <span class="n">model_simple</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">A_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="evaluation-with-train-data">
<h3>Evaluation with train-data<a class="headerlink" href="#evaluation-with-train-data" title="Permalink to this headline">¶</a></h3>
<p>We already achieve a solid r2 and adjustend r2 score with the simple model. We can explain about <strong>73%</strong> of the dispersion around the mean with the model. We obtain similar values in cross-validation. This means that also with resampling our data, the model retains a similar quality.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#print r2 scores and save in df</span>
<span class="nb">print</span><span class="p">(</span><span class="n">r2_score</span><span class="p">(</span><span class="n">b_train</span><span class="p">,</span> <span class="n">b_pred</span><span class="p">))</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">adj_r2</span><span class="p">(</span><span class="n">r2_score</span><span class="p">(</span><span class="n">b_train</span><span class="p">,</span> <span class="n">b_pred</span><span class="p">),</span> <span class="n">b_train</span><span class="p">,</span> <span class="n">A_train</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cross_val_score</span><span class="p">(</span><span class="n">model_simple</span><span class="p">,</span> <span class="n">A_train</span><span class="p">,</span> <span class="n">b_train</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;r2&#39;</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>

<span class="c1">#asve scores in dictionary</span>
<span class="n">scores</span><span class="p">[</span><span class="s1">&#39;model_simple&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">r2_score</span><span class="p">(</span><span class="n">b_train</span><span class="p">,</span> <span class="n">b_pred</span><span class="p">),</span> <span class="n">adj_r2</span><span class="p">(</span><span class="n">r2_score</span><span class="p">(</span><span class="n">b_train</span><span class="p">,</span> <span class="n">b_pred</span><span class="p">),</span> <span class="n">b_train</span><span class="p">,</span> <span class="n">A_train</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7347491426154187
0.7346764910521799
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/sophiaengstler/opt/anaconda3/envs/jbook/lib/python3.7/site-packages/sklearn/feature_selection/_univariate_selection.py:111: RuntimeWarning: invalid value encountered in true_divide
  msw = sswn / float(dfwn)
/Users/sophiaengstler/opt/anaconda3/envs/jbook/lib/python3.7/site-packages/sklearn/feature_selection/_univariate_selection.py:111: RuntimeWarning: invalid value encountered in true_divide
  msw = sswn / float(dfwn)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/sophiaengstler/opt/anaconda3/envs/jbook/lib/python3.7/site-packages/sklearn/feature_selection/_univariate_selection.py:111: RuntimeWarning: invalid value encountered in true_divide
  msw = sswn / float(dfwn)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/sophiaengstler/opt/anaconda3/envs/jbook/lib/python3.7/site-packages/sklearn/feature_selection/_univariate_selection.py:111: RuntimeWarning: invalid value encountered in true_divide
  msw = sswn / float(dfwn)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.73851868 0.7273026  0.7346638  0.74064071 0.73166662]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/sophiaengstler/opt/anaconda3/envs/jbook/lib/python3.7/site-packages/sklearn/feature_selection/_univariate_selection.py:111: RuntimeWarning: invalid value encountered in true_divide
  msw = sswn / float(dfwn)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot outputs</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">A_train</span><span class="p">,</span> <span class="n">b_train</span><span class="p">,</span>  <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">A_train</span><span class="p">,</span> <span class="n">b_pred</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkred&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Regression_Marketing_46_0.png" src="_images/Regression_Marketing_46_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">residplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">b_pred</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">b_train</span><span class="p">,</span> <span class="n">scatter_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;s&quot;</span><span class="p">:</span> <span class="mi">80</span><span class="p">});</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Regression_Marketing_47_0.png" src="_images/Regression_Marketing_47_0.png" />
</div>
</div>
<p>The plots reveal a relatively equal deviation. The line fits appropriately in the scatterplot and is not affected by outliers. However, this simple model gives no insight into how the budget should be distributed among the different channels. Therefore, we will now develop further models, which consider the information divided by channels and influencer type.</p>
</div>
</div>
<div class="section" id="multiple-linear-regression">
<h2>Multiple linear Regression<a class="headerlink" href="#multiple-linear-regression" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id1">
<h3>Prepare Features and target variable<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>As all numerical features have a medium to strong correlation with our target variable <strong>sales</strong> we will include all features into our multiple regression model. We will also include the categorial variable <em>Influencer</em> in our featureset and test its impact. We assume only a low impact of this variable, because it didn’t show a significant correlation with the target variable in the boxplot. In the hyperparameter tuning we will test different feature selections by application of SelectKBest().</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Train-Data</span>
<span class="c1"># Select features for multiple regression</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">train_df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;Total_spent&#39;</span><span class="p">,</span><span class="s1">&#39;Sales&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Create response</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">train_df</span><span class="p">[</span><span class="s1">&#39;Sales&#39;</span><span class="p">]</span>

<span class="c1"># Test-Data</span>
<span class="c1"># Select features for simple regression</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">test_df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;Total_spent&#39;</span><span class="p">,</span><span class="s1">&#39;Sales&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Create response</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">test_df</span><span class="p">[</span><span class="s1">&#39;Sales&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id2">
<h3>Fit Data<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<div class="section" id="standard-multiple-regression">
<h4>Standard multiple regression<a class="headerlink" href="#standard-multiple-regression" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model_multi</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/sophiaengstler/opt/anaconda3/envs/jbook/lib/python3.7/site-packages/sklearn/feature_selection/_univariate_selection.py:111: RuntimeWarning: invalid value encountered in true_divide
  msw = sswn / float(dfwn)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_pred</span> <span class="o">=</span> <span class="n">model_multi</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7522751246935171
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="perform-hyperparameter-tuning">
<h4>Perform Hyperparameter tuning<a class="headerlink" href="#perform-hyperparameter-tuning" title="Permalink to this headline">¶</a></h4>
<p>We want to test if we could improve the performance by hyperparameter tuning.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Hyperparameter tuning</span>
<span class="n">params</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&#39;chi__k&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;all&#39;</span><span class="p">],</span>
    <span class="s1">&#39;lm__fit_intercept&#39;</span><span class="p">:[</span><span class="kc">True</span><span class="p">,</span><span class="kc">False</span><span class="p">],</span> 
    <span class="s1">&#39;lm__normalize&#39;</span><span class="p">:[</span><span class="kc">True</span><span class="p">,</span><span class="kc">False</span><span class="p">],</span> 
    <span class="s1">&#39;lm__copy_X&#39;</span><span class="p">:[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span>
    <span class="c1"># max_iter: Maximale Anzahl an Durchläufen, tol=Beenden des Durchlaufs, sobald man nahe genug an bestimmtem Wert ist</span>
    
<span class="p">}</span>
<span class="c1"># Erstellung der GridSearch</span>
<span class="n">gs</span><span class="o">=</span><span class="n">GridSearchCV</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">pipe</span><span class="p">,</span><span class="n">param_grid</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span><span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="c1"># Model wird trainiert</span>
<span class="n">model_multi_tuned</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Ausgabe der besten Parameter</span>
<span class="n">model_multi_tuned</span><span class="o">.</span><span class="n">best_params_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/sophiaengstler/opt/anaconda3/envs/jbook/lib/python3.7/site-packages/sklearn/feature_selection/_univariate_selection.py:111: RuntimeWarning: invalid value encountered in true_divide
  msw = sswn / float(dfwn)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;chi__k&#39;: &#39;all&#39;,
 &#39;lm__copy_X&#39;: True,
 &#39;lm__fit_intercept&#39;: True,
 &#39;lm__normalize&#39;: True}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_pred_tuned</span><span class="o">=</span><span class="n">model_multi_tuned</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="evaluate-data-with-trainings-set">
<h3>Evaluate data with trainings-set<a class="headerlink" href="#evaluate-data-with-trainings-set" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#print r2 scores and save in dictionary</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Multiple regression without hyperparameter tuning: &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">adj_r2</span><span class="p">(</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">),</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_train</span><span class="p">))</span>
<span class="c1">#print(cross_val_score(model_multi, X_train, y_train, scoring=&#39;r2&#39;, cv=5))</span>

<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Multiple regression with hyperparameter tuning: &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred_tuned</span><span class="p">))</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">adj_r2</span><span class="p">(</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred_tuned</span><span class="p">),</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_train</span><span class="p">))</span>
<span class="c1">#print(cross_val_score(model_multi_tuned, X_train, y_train, scoring=&#39;r2&#39;, cv=5))</span>

<span class="c1">#Add to dictionary</span>
<span class="n">scores</span><span class="p">[</span><span class="s1">&#39;model_multi&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">),</span> <span class="n">adj_r2</span><span class="p">(</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">),</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_train</span><span class="p">)]</span>
<span class="n">scores</span><span class="p">[</span><span class="s1">&#39;model_multi_tuned&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred_tuned</span><span class="p">),</span> <span class="n">adj_r2</span><span class="p">(</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred_tuned</span><span class="p">),</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_train</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Multiple regression without hyperparameter tuning: 
0.7522751246935171
0.7520714594082555
Multiple regression with hyperparameter tuning: 
0.7522751246935171
0.7520714594082555
</pre></div>
</div>
</div>
</div>
<p>As the tuning of the multiple linear model has no effect and returns the standard parameter, we will evaluate the residplot with the non-tuned variant.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">residplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span> <span class="n">scatter_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;s&quot;</span><span class="p">:</span> <span class="mi">80</span><span class="p">});</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Regression_Marketing_61_0.png" src="_images/Regression_Marketing_61_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="lasso-regression">
<h2>Lasso Regression<a class="headerlink" href="#lasso-regression" title="Permalink to this headline">¶</a></h2>
<p>Although the correlation plots show a mainly linear correlation we will try if we can improve the model score by applying the lasso Regression Algorithm.</p>
<div class="section" id="find-best-alpha">
<h3>Find best alpha<a class="headerlink" href="#find-best-alpha" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LassoCV</span>

<span class="c1"># Lasso with 5 fold cross-validation</span>
<span class="n">best_alpha</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="n">lm</span> <span class="o">=</span> <span class="n">LassoCV</span><span class="p">(</span><span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">10000</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fit model</span>
<span class="n">best_alpha</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/sophiaengstler/opt/anaconda3/envs/jbook/lib/python3.7/site-packages/sklearn/feature_selection/_univariate_selection.py:111: RuntimeWarning: invalid value encountered in true_divide
  msw = sswn / float(dfwn)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pipeline(steps=[(&#39;preprocessor&#39;,
                 ColumnTransformer(transformers=[(&#39;num&#39;,
                                                  Pipeline(steps=[(&#39;imputer&#39;,
                                                                   SimpleImputer(fill_value=0,
                                                                                 strategy=&#39;constant&#39;)),
                                                                  (&#39;scaler&#39;,
                                                                   StandardScaler())]),
                                                  &lt;sklearn.compose._column_transformer.make_column_selector object at 0x7fa683a54e10&gt;),
                                                 (&#39;cat&#39;,
                                                  Pipeline(steps=[(&#39;onehot&#39;,
                                                                   OneHotEncoder(handle_unknown=&#39;ignore&#39;))]),
                                                  &lt;sklearn.compose._column_transformer.make_column_selector object at 0x7fa683a54ed0&gt;)])),
                (&#39;chi&#39;, SelectKBest(k=&#39;all&#39;)),
                (&#39;lm&#39;, LassoCV(cv=5, max_iter=10000, random_state=0))])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">best_alpha</span><span class="p">[</span><span class="s1">&#39;lm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">alpha_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.5680379551613485
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="perform-modeling">
<h3>Perform Modeling<a class="headerlink" href="#perform-modeling" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">Lasso</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lasso</span><span class="o">=</span><span class="n">pipe</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="n">lm</span> <span class="o">=</span> <span class="n">Lasso</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">best_alpha</span><span class="p">[</span><span class="s1">&#39;lm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">alpha_</span><span class="p">))</span>
<span class="n">model_lasso</span> <span class="o">=</span> <span class="n">lasso</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/sophiaengstler/opt/anaconda3/envs/jbook/lib/python3.7/site-packages/sklearn/feature_selection/_univariate_selection.py:111: RuntimeWarning: invalid value encountered in true_divide
  msw = sswn / float(dfwn)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">model_lasso</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7521661193754694
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scores</span><span class="p">[</span><span class="s1">&#39;model_lasso&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">model_lasso</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">),</span> <span class="n">adj_r2</span><span class="p">(</span><span class="n">model_lasso</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">),</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_train</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Show model coefficients and names</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">model_lasso</span><span class="p">[</span><span class="s1">&#39;lm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">coef_</span><span class="p">,</span> <span class="n">X_train</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(79.79394314732825, &#39;Print&#39;), (0.2602741271073183, &#39;Social&#39;), (0.0, &#39;Influencer&#39;)]
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="gradient-boosting-regressor">
<h2>Gradient Boosting Regressor<a class="headerlink" href="#gradient-boosting-regressor" title="Permalink to this headline">¶</a></h2>
<p>We will also test the performance of the gradient boosting regressor as it has shown to be very effective. It combines the estimates of a set of simpler, weaker models in order to iteratively create a more accurate model. It uses a gradient descent algorithm to minimize the loss when adding new models.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">GradientBoostingRegressor</span>

<span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;n_estimators&quot;</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span>
    <span class="s2">&quot;max_depth&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
    <span class="s2">&quot;min_samples_split&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
    <span class="s2">&quot;learning_rate&quot;</span><span class="p">:</span> <span class="mf">0.01</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#xgb benötigt array</span>
<span class="n">xgb</span><span class="o">=</span><span class="n">pipe</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="n">lm</span> <span class="o">=</span> <span class="n">GradientBoostingRegressor</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">))</span>
<span class="n">model_xgb</span> <span class="o">=</span> <span class="n">xgb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/sophiaengstler/opt/anaconda3/envs/jbook/lib/python3.7/site-packages/sklearn/feature_selection/_univariate_selection.py:111: RuntimeWarning: invalid value encountered in true_divide
  msw = sswn / float(dfwn)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model_xgb</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([244.04091215, 233.55420311, 249.55457967, ...,  72.83820264,
        93.30763014, 196.59507722])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">model_xgb</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7883465944901054
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scores</span><span class="p">[</span><span class="s1">&#39;model_xgb&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">model_xgb</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">),</span> <span class="n">adj_r2</span><span class="p">(</span><span class="n">model_xgb</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">),</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_train</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Print</th>
      <th>Social</th>
      <th>Influencer</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3398</th>
      <td>23.135876</td>
      <td>1.406370</td>
      <td>Nano</td>
    </tr>
    <tr>
      <th>1336</th>
      <td>22.158559</td>
      <td>2.197681</td>
      <td>Macro</td>
    </tr>
    <tr>
      <th>3992</th>
      <td>24.395032</td>
      <td>7.606385</td>
      <td>Micro</td>
    </tr>
    <tr>
      <th>3822</th>
      <td>30.967923</td>
      <td>5.586193</td>
      <td>Nano</td>
    </tr>
    <tr>
      <th>3065</th>
      <td>28.373831</td>
      <td>4.539822</td>
      <td>Mega</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3436</th>
      <td>29.722854</td>
      <td>1.837938</td>
      <td>Nano</td>
    </tr>
    <tr>
      <th>2745</th>
      <td>14.493722</td>
      <td>0.737132</td>
      <td>Micro</td>
    </tr>
    <tr>
      <th>2317</th>
      <td>2.881749</td>
      <td>1.830336</td>
      <td>Nano</td>
    </tr>
    <tr>
      <th>1389</th>
      <td>6.151247</td>
      <td>1.483988</td>
      <td>Macro</td>
    </tr>
    <tr>
      <th>2234</th>
      <td>19.166566</td>
      <td>4.879308</td>
      <td>Mega</td>
    </tr>
  </tbody>
</table>
<p>3653 rows × 3 columns</p>
</div></div></div>
</div>
<div class="section" id="feature-importance">
<h3>Feature Importance<a class="headerlink" href="#feature-importance" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reg</span><span class="o">=</span><span class="n">model_xgb</span><span class="p">[</span><span class="s1">&#39;lm&#39;</span><span class="p">]</span>
<span class="n">reg</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GradientBoostingRegressor(learning_rate=0.01, max_depth=4, min_samples_split=5,
                          n_estimators=500)
</pre></div>
</div>
</div>
</div>
<p style='color:red'>Wieso 5 Feature Importances bei nur 3 Features?</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reg</span><span class="o">.</span><span class="n">feature_importances_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([9.88769791e-01, 9.60530467e-03, 3.41919128e-04, 5.47509693e-04,
       2.28847477e-04, 5.06628407e-04])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.inspection</span> <span class="kn">import</span> <span class="n">permutation_importance</span>

<span class="n">feature_importance</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="n">sorted_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">feature_importance</span><span class="p">)</span>
<span class="n">pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">sorted_idx</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="mf">0.5</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">feature_importance</span><span class="p">[</span><span class="n">sorted_idx</span><span class="p">],</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">columns</span><span class="p">)[</span><span class="n">sorted_idx</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Feature Importance (MDI)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Feature Importance (MDI)&#39;)
</pre></div>
</div>
<img alt="_images/Regression_Marketing_84_1.png" src="_images/Regression_Marketing_84_1.png" />
</div>
</div>
<p>The plot reveals that <em>Print</em> has by far the highest impact on our model prediction. This is due to the fact that there is also a significantly higher correlation between the feature and our target variable. The categorical variable Influencer, on the other hand, has little to no influence on the model. This was expected as the boxplots showed a mostly even distribution in the dataframe.</p>
</div>
</div>
<div class="section" id="comparing-the-different-models">
<h2>Comparing the different models<a class="headerlink" href="#comparing-the-different-models" title="Permalink to this headline">¶</a></h2>
<p>The multi regression model with all features generated a slightly higher r2-score as our simple regression model. Also, the adjusted R2 score is higher, which means that even with a higher complexity and more features, the model has a better performans than the simple one. However, as mentioned before we couldn’t improve the quality of our multi regression model by hyperparameter tuning.<br></br>
The correlation plots revealed a linear distribution. Therefore, we couldn’t improve our scores with the Lasso algorithm. <br></br>
The highest r2 and adjusted r2-score was achieved with the XGBoost algorithm.
Therefore, we decide to use the <strong>Gradient Boosting Tree Regression Model</strong> and test its performance on our test dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print all scores</span>
<span class="n">df_score</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;R2&#39;</span><span class="p">,</span> <span class="s1">&#39;Adjusted R2&#39;</span><span class="p">])</span>
<span class="n">df_score</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>R2</th>
      <th>Adjusted R2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>model_simple</th>
      <td>0.734749</td>
      <td>0.734676</td>
    </tr>
    <tr>
      <th>model_multi</th>
      <td>0.752275</td>
      <td>0.752071</td>
    </tr>
    <tr>
      <th>model_multi_tuned</th>
      <td>0.752275</td>
      <td>0.752071</td>
    </tr>
    <tr>
      <th>model_lasso</th>
      <td>0.752166</td>
      <td>0.751962</td>
    </tr>
    <tr>
      <th>model_xgb</th>
      <td>0.788347</td>
      <td>0.788173</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="evaluation-with-test-data">
<h1>Evaluation with Test-Data<a class="headerlink" href="#evaluation-with-test-data" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_test_pred</span> <span class="o">=</span> <span class="n">model_xgb</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;XGBoost Regressor without hyperparameter tuning: &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_test_pred</span><span class="p">))</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">adj_r2</span><span class="p">(</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_test_pred</span><span class="p">),</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">X_test</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>XGBoost Regressor without hyperparameter tuning: 
0.7556960822408199
0.7548897986838589
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">residplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">y_test_pred</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_test</span><span class="p">,</span> <span class="n">scatter_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;s&quot;</span><span class="p">:</span> <span class="mi">80</span><span class="p">});</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Regression_Marketing_91_0.png" src="_images/Regression_Marketing_91_0.png" />
</div>
</div>
<p>The application of the model shows a similar result to the performance with our trainings-dataset. Therefore, it is probably neither over- or underfitted.</p>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="conclusion">
<h1>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p>The model explains around 75-78% of the deviation of the values.</p></li>
<li><p>By knowing how much money we spent for a certain campaign, we can now predict, how much sales we will generate.</p></li>
<li><p>This can help to check, whether a campaign has achieved the expected result or performed comparatively poorly or above average.</p></li>
<li><p>Additionally, we can now predict website traffic and demand based on our campaigns to take certain precautions.</p></li>
<li><p>Feature importance has shown that spendings on Print have the biggest impact. One reason for this could be that spending on this channel is higher than on the other channel.</p></li>
<li><p>The Influencer type we work with in a social media campaign showed low to zero impact on our sales.</p></li>
</ul>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="Regression.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">Regression</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="Clustering.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">Clustering</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          Durch Sophia Engstler<br/>
        
            &copy; Urheberrechte © 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>